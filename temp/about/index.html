<script>
  class Cloud {
    constructor() {
      this.x = random(width);
      let amt = pow(random(), 0.5) * scale;
      this.y = ((scale - amt) * height) / 3;
      amt = amt * 0.8 + 0.2;
      this.w = amt * random(200, 600);
      this.h = amt * random(100, 200);
      this.amt = amt;
    }
    render(buffer) {
      buffer.push();
      buffer.translate(this.x, this.y);
      buffer.noStroke();
      for (let i = 200; i > 0; i--) {
        let amt = i / 200;
        let s = random(40, 100) * this.amt;
        buffer.fill(0.1, amt * 0.8, amt * 0.6 + 0.4, 0.4);
        let a = (1 - abs(amt * 2 - 1)) * 0.8 + 0.2;
        let x = random(-0.5, 0.5) * this.w * a;
        let y = amt * this.h;
        buffer.ellipse(x, y, s);
      }
      buffer.pop();
    }
  }

  function setup() {
    pixelDensity(1);
    createCanvas();
    colorMode(HSB, 1, 1, 1);
    windowResized();
  }

  let buffer;
  let scale;
  let init = () => {
    buffer = createGraphics(width, height);
    buffer.colorMode(HSB, 1, 1, 1);

    scale = height / 800;

    buffer.background(0);
    for (let i = 0; i < height / 2; i++) {
      let amt = i / (height / 2);
      let amt2 = pow(amt, 1.5);
      let hue = 0.05 + 0.6 * (1 - amt);
      let sat = 0.1 + (0.9 * (cos(amt2 * TAU) + 1)) / 2;
      buffer.stroke(hue, sat, 1);
      buffer.line(0, i, width, i);
    }

    let clouds = [];
    let n = floor((20 * width) / 800);
    for (let i = 0; i < n; i++) {
      clouds.push(new Cloud());
    }

    clouds = clouds.sort((a, b) => b.y - a.y);
    clouds.forEach((c) => c.render(buffer));

    buffer.blendMode(ADD);
    buffer.noStroke();
    let s = height * 0.15;
    buffer.fill(0.1, 0.8, 1, 0.1);
    for (let i = 0; i < 30; i++) {
      buffer.ellipse(width / 2, height / 2, s + (i * s) / 30);
    }
  };

  function draw() {
    blendMode(BLEND);
    image(buffer, 0, 0);
    let h = floor(height / 2);
    translate(0, h - 1);
    for (let i = 0; i < h + 1; i++) {
      let y = h - floor(i / 4) - 2;
      let n = noise(i / 10 + frameCount / 50, frameCount / 100);
      let n2 = noise(i / 10 + frameCount / 100, frameCount / 200, 10000);
      let w = (n - 0.5) * h * (i / h);
      let x = (((n2 - 0.5) * h) / 2) * (i / h);
      image(buffer, -w / 2 + x, i, width + w, 1, 0, y, width, 1);
    }

    noStroke();
    blendMode(ADD);
    fill(0.6, 1, 1, 0.3);
    rect(0, 0, width, h + 1);
    blendMode(BLEND);
    rect(0, 0, width, h + 1);

    blendMode(DARKEST);
    for (let i = 0; i < h + 1; i++) {
      let amt = i / h;
      stroke(0.6, 1, amt, 1 - amt);
      line(0, i, width, i);
    }
  }

  function mousePressed() {
    init();
  }

  function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
    init();
  }
</script>
<style>
  * {
    margin: 0;
    padding: 0;
  }
  html,
  body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
  }
  canvas {
    display: block;
  }
  #controls {
    z-index: 2;
    margin: 20px;
    position: absolute;
    top: 0;
    left: 0;
    color: white;
  }
</style>

<div id="controls"></div>
<div id="modal">
  <p id="header">About this project</p><br/>
  <p>This Project was developed by a few Humans from Earth.</p><br/>
  <p>It's source code is proprietary for now.</p>
</div>
<style>
  #header{
  font-size:20px;
  text-align:center;
  font-weight:bold;
}
#modal {
 position: absolute;
 top: auto;
 bottom: 50%;
 left: auto;
 right: 50%;
 transform: translate(50%,50%);
 width: 300px;
 backdrop-filter: blur(10px);
 background-color: rgba(255, 255, 255, 0.5);
 max-width: 50%;
 padding: 25px;
 border-radius: 25px;
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js"></script>
